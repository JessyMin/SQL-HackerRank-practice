# 2018.3.20 MySQL

# 'New Companies' challenge
# (source : https://www.hackerrank.com/challenges/the-company/problem)

SELECT c.company_code
    , c.founder
    , num.l_manager
    , num.s_manager
    , num.manager
    , num.employee
FROM company as c
JOIN (SELECT company_code
		, COUNT(DISTINCT(lead_manager_code)) as l_manager
		, COUNT(DISTINCT(senior_manager_code)) as s_manager
		, COUNT(DISTINCT(manager_code)) as manager
		, COUNT(DISTINCT(employee_code)) as employee
	  FROM employee
	  GROUP BY company_code) as num
ON c.company_code = num.company_code
ORDER BY company_code;
