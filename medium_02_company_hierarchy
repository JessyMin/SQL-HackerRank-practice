# 2018.3.20 MySQL

# 'New Companies' challenge
# (source : https://www.hackerrank.com/challenges/the-company/problem)

SELECT c.company_code
    , c.founder
    , e.l_manager
    , e.s_manager
    , e.manager
    , e.employee
FROM company as c
JOIN (SELECT company_code
  		, COUNT(DISTINCT(lead_manager_code)) as l_manager
  		, COUNT(DISTINCT(senior_manager_code)) as s_manager
  		, COUNT(DISTINCT(manager_code)) as manager
  		, COUNT(DISTINCT(employee_code)) as employee
  	  FROM employee
  	  GROUP BY company_code) as e
ON c.company_code = e.company_code
ORDER BY company_code;
